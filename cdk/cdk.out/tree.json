{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.219.0"},"children":{"DataPipelineStack":{"id":"DataPipelineStack","path":"DataPipelineStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.219.0"},"children":{"DataBucket":{"id":"DataBucket","path":"DataPipelineStack/DataBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataPipelineStack/DataBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"DataPipelineStack/DataBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataPipelineStack/DataBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"DataBucketE3889A50"},"policyDocument":{"Statement":[{"Action":["s3:PutBucketPolicy","s3:GetBucket*","s3:List*","s3:DeleteObject*"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"DataPipelineStack/DataBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.219.0","metadata":[]},"children":{"Default":{"id":"Default","path":"DataPipelineStack/DataBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"DataPipelineStack/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.219.0"},"children":{"Staging":{"id":"Staging","path":"DataPipelineStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.219.0"}},"Role":{"id":"Role","path":"DataPipelineStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}},"Handler":{"id":"Handler","path":"DataPipelineStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}}}},"AthenaResults":{"id":"AthenaResults","path":"DataPipelineStack/AthenaResults","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataPipelineStack/AthenaResults/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"DataPipelineStack/AthenaResults/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataPipelineStack/AthenaResults/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"AthenaResults99A60126"},"policyDocument":{"Statement":[{"Action":["s3:PutBucketPolicy","s3:GetBucket*","s3:List*","s3:DeleteObject*"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["AthenaResults99A60126","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AthenaResults99A60126","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"DataPipelineStack/AthenaResults/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.219.0","metadata":[]},"children":{"Default":{"id":"Default","path":"DataPipelineStack/AthenaResults/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}}}}}},"DepsLayer":{"id":"DepsLayer","path":"DataPipelineStack/DepsLayer","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.LayerVersion","version":"2.219.0","metadata":[]},"children":{"Code":{"id":"Code","path":"DataPipelineStack/DepsLayer/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.219.0"},"children":{"Stage":{"id":"Stage","path":"DataPipelineStack/DepsLayer/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.219.0"}},"AssetBucket":{"id":"AssetBucket","path":"DataPipelineStack/DepsLayer/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.219.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"DataPipelineStack/DepsLayer/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnLayerVersion","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::LayerVersion","aws:cdk:cloudformation:props":{"compatibleRuntimes":["python3.12"],"content":{"s3Bucket":"cdk-hnb659fds-assets-339712743071-us-east-1","s3Key":"81ddcad0c68dbe9c920d77ca3fb4155a7cdd9033a2aa708525b133f0b003e9b6.zip"},"description":"Prebuilt deps (requests, pyarrow, etc.)"}}}}},"LambdaRole":{"id":"LambdaRole","path":"DataPipelineStack/LambdaRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.219.0","metadata":[]},"children":{"ImportLambdaRole":{"id":"ImportLambdaRole","path":"DataPipelineStack/LambdaRole/ImportLambdaRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Resource":{"id":"Resource","path":"DataPipelineStack/LambdaRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DataPipelineStack/LambdaRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataPipelineStack/LambdaRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"LambdaRoleDefaultPolicy75625A82","roles":[{"Ref":"LambdaRole3A44B857"}]}}}}}}},"ExtractorFunction":{"id":"ExtractorFunction","path":"DataPipelineStack/ExtractorFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.219.0","metadata":[]},"children":{"Code":{"id":"Code","path":"DataPipelineStack/ExtractorFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.219.0"},"children":{"Stage":{"id":"Stage","path":"DataPipelineStack/ExtractorFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.219.0"}},"AssetBucket":{"id":"AssetBucket","path":"DataPipelineStack/ExtractorFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.219.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"DataPipelineStack/ExtractorFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-339712743071-us-east-1","s3Key":"9139a3bf5a007bc516f3448f42a8050cd9456943927e23b4fe6d3a62223e3cd3.zip"},"environment":{"variables":{"BUCKET":{"Ref":"DataBucketE3889A50"},"API_URL":"https://randomuser.me/api/?results=100","FILE_FORMAT":"parquet"}},"handler":"lambda_function.handler","layers":[{"Ref":"DepsLayerA0D7F79A"}],"role":{"Fn::GetAtt":["LambdaRole3A44B857","Arn"]},"runtime":"python3.12","timeout":60}}}}},"GlueDB":{"id":"GlueDB","path":"DataPipelineStack/GlueDB","constructInfo":{"fqn":"aws-cdk-lib.aws_glue.CfnDatabase","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Glue::Database","aws:cdk:cloudformation:props":{"catalogId":"339712743071","databaseInput":{"name":"users_db"}}}},"CrawlerRole":{"id":"CrawlerRole","path":"DataPipelineStack/CrawlerRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.219.0","metadata":[]},"children":{"ImportCrawlerRole":{"id":"ImportCrawlerRole","path":"DataPipelineStack/CrawlerRole/ImportCrawlerRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Resource":{"id":"Resource","path":"DataPipelineStack/CrawlerRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"glue.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AdministratorAccess"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DataPipelineStack/CrawlerRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataPipelineStack/CrawlerRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"CrawlerRoleDefaultPolicy145A4322","roles":[{"Ref":"CrawlerRoleA9495AEE"}]}}}}}}},"DataPipelineDataLakeSettings":{"id":"DataPipelineDataLakeSettings","path":"DataPipelineStack/DataPipelineDataLakeSettings","constructInfo":{"fqn":"aws-cdk-lib.aws_lakeformation.CfnDataLakeSettings","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::LakeFormation::DataLakeSettings","aws:cdk:cloudformation:props":{"admins":[{"dataLakePrincipalIdentifier":{"Fn::GetAtt":["CrawlerRoleA9495AEE","Arn"]}}]}}},"GlueDBPerms":{"id":"GlueDBPerms","path":"DataPipelineStack/GlueDBPerms","constructInfo":{"fqn":"aws-cdk-lib.aws_lakeformation.CfnPermissions","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::LakeFormation::Permissions","aws:cdk:cloudformation:props":{"dataLakePrincipal":{"dataLakePrincipalIdentifier":{"Fn::GetAtt":["CrawlerRoleA9495AEE","Arn"]}},"permissions":["CREATE_TABLE","ALTER","DESCRIBE"],"resource":{"databaseResource":{"name":"users_db"}}}}},"UsersCrawler":{"id":"UsersCrawler","path":"DataPipelineStack/UsersCrawler","constructInfo":{"fqn":"aws-cdk-lib.aws_glue.CfnCrawler","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Glue::Crawler","aws:cdk:cloudformation:props":{"databaseName":{"Ref":"GlueDB"},"role":{"Fn::GetAtt":["CrawlerRoleA9495AEE","Arn"]},"schemaChangePolicy":{"deleteBehavior":"LOG","updateBehavior":"UPDATE_IN_DATABASE"},"targets":{"s3Targets":[{"path":{"Fn::Join":["",["s3://",{"Ref":"DataBucketE3889A50"},"/"]]}}]}}}},"LFDataLocation":{"id":"LFDataLocation","path":"DataPipelineStack/LFDataLocation","constructInfo":{"fqn":"aws-cdk-lib.aws_lakeformation.CfnResource","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::LakeFormation::Resource","aws:cdk:cloudformation:props":{"resourceArn":{"Fn::GetAtt":["DataBucketE3889A50","Arn"]},"roleArn":{"Fn::GetAtt":["CrawlerRoleA9495AEE","Arn"]},"useServiceLinkedRole":false}}},"CrawlerPerms":{"id":"CrawlerPerms","path":"DataPipelineStack/CrawlerPerms","constructInfo":{"fqn":"aws-cdk-lib.aws_lakeformation.CfnPermissions","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::LakeFormation::Permissions","aws:cdk:cloudformation:props":{"dataLakePrincipal":{"dataLakePrincipalIdentifier":{"Fn::GetAtt":["CrawlerRoleA9495AEE","Arn"]}},"permissions":["ALL"],"resource":{"databaseResource":{"name":"users_db"}}}}},"CrawlerPermst":{"id":"CrawlerPermst","path":"DataPipelineStack/CrawlerPermst","constructInfo":{"fqn":"aws-cdk-lib.aws_lakeformation.CfnPermissions","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::LakeFormation::Permissions","aws:cdk:cloudformation:props":{"dataLakePrincipal":{"dataLakePrincipalIdentifier":{"Fn::GetAtt":["CrawlerRoleA9495AEE","Arn"]}},"permissions":["DATA_LOCATION_ACCESS"],"resource":{"dataLocationResource":{"s3Resource":{"Fn::GetAtt":["DataBucketE3889A50","Arn"]}}}}}},"LambdaPerms":{"id":"LambdaPerms","path":"DataPipelineStack/LambdaPerms","constructInfo":{"fqn":"aws-cdk-lib.aws_lakeformation.CfnPermissions","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::LakeFormation::Permissions","aws:cdk:cloudformation:props":{"dataLakePrincipal":{"dataLakePrincipalIdentifier":{"Fn::GetAtt":["LambdaRole3A44B857","Arn"]}},"permissions":["DATA_LOCATION_ACCESS"],"resource":{"dataLocationResource":{"s3Resource":{"Fn::GetAtt":["DataBucketE3889A50","Arn"]}}}}}},"AthenaWG":{"id":"AthenaWG","path":"DataPipelineStack/AthenaWG","constructInfo":{"fqn":"aws-cdk-lib.aws_athena.CfnWorkGroup","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Athena::WorkGroup","aws:cdk:cloudformation:props":{"name":"users_wg","workGroupConfiguration":{"resultConfiguration":{"outputLocation":{"Fn::Join":["",["s3://",{"Ref":"AthenaResults99A60126"},"/results/"]]}}}}}},"DataBucketNameOutput":{"id":"DataBucketNameOutput","path":"DataPipelineStack/DataBucketNameOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"GlueDBNameOutput":{"id":"GlueDBNameOutput","path":"DataPipelineStack/GlueDBNameOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"LambdaNameOutput":{"id":"LambdaNameOutput","path":"DataPipelineStack/LambdaNameOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"DataPipelineStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"DataPipelineStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"DataPipelineStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.219.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"DataPipelineStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.219.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}